/*! jQuery.Terminal */
!function(a){var b=function(a,b){this.$display=a,this.$input=b};b.prototype=Object.create(b.prototype),b.prototype.constructor=b;var c={goTo:function(b,c){return null!==c&&""!==c&&void 0!==c&&(window.location=c),a(name).length>0?(setTimeout(function(){a("html, body").animate({scrollTop:a(elID).offset().top-100},1e3)},500),"Taking you to <span class='highlight'>"+b+"</span>.."):"Cannot find <span class='highlight'>"+b+"</span>.."},playSong:function(b){var c="http://phpete.me/sites/default/files/"+b+".mp3";return e.audioLoaded?(e.playAudio(e.audioEl()),!0):void a(e.audioEl(c)).load(c,function(a,c,d){"error"==c?(e.update("Cannot find song '"+b+"'",null),e.audioLoaded=!1):(e.update("Playing "+b+"..",null),e.playAudio(e.audioEl()),e.audioLoaded=!0)})}},d={clicks:[],desktopClicks:function(){return d.clicks[0]=function(){a(e.image).unbind("click"),e.currentClick+=1,e.currentClick<d.clicks.length&&a(e.image).bind("click",d.clicks[e.currentClick]),e.aboveOutput="[login]<br />type <i>help</i> for instructions<br />",e.update(),e.focusCursor()},d.clicks[1]=function(b){return a(b.target).hasClass("input")?!1:void e.focusCursor()},d.clicks},keyboardEvents:function(){var b={};return b[e.input]=function(b){switch(b.keyCode){case 13:e.currentLine=a(e.input).text().trim();var c=e.currentLine,d=e.processCommand(c);return d?e.commandsList.push(c):(e.aboveOutput="Unrecognized command, try again or<br />type <span class='highlight'>help</span> for options<br />",e.update()),e.focusCursor(),!1;case 38:var f=e.commandsList[e.commandsList.length-1];if(void 0===f)return!1;e.aboveOutput=e.beginCommandStr+f,e.currentLine=f,e.update()}},b},mobileClicks:function(){var a=[];return a}},e={commandsList:[],clientScreen:"",currentClick:0,deviceDependentText:"",initalized:!1,audioLoaded:!1,image:".iMac-img, #iMac .terminal",input:"#iMac .terminal .input",terminal:"#iMac .terminal",audioElement:"#audio",aboveOutput:"",currentLine:"",availableCommands:"<span class='highlight'>clear</span> - Clear output<br /><span class='highlight'>help</span> - Display all available commands<br /><span class='highlight'>play song</span> - I'll play a song on the piano<br /><span class='highlight'>project [#]</span> - Go to a project where [#] is the project ID<br /><span class='highlight'>shutdown</span> - sign off this site<br />",beginCommandStr:"<span class='begin-command'>$&nbsp;</span>",greeting:this.beginCommandStr+" print greeting();<br />Hello, World!<br />Welcome to <span class='highlight'>JS Terminal</span><br><br>This is a fully customizable, interactive terminal<br><span class='highlight'>click me!</span>",audioEl:function(b){b=void 0===b||null===b?"":b;var c=null,d=e.audioElement;return 0===a(d).length?(c=document.createElement("audio"),c.setAttribute("src",b),c.setAttribute("autoplay","autoplay")):c=a(d).get(0),c},init:function(){e.initDeviceSpecificSettings(),e.registerEvents(),e.initalized=!0},initDeviceSpecificSettings:function(){e.clientScreen="desktop",a(e.terminal).css("cursor","pointer"),e.deviceDependentText="This is my iMac, you can<br />interact with it by clicking on it"},focusCursor:function(){var b,c,d=a(e.input)[0];b=document.createRange(),b.selectNodeContents(d),b.collapse(!1),c=window.getSelection(),c.removeAllRanges(),c.addRange(b),d.focus()},processCommand:function(b){var d=!0,f=null;if(b=b.trim(),""===b)return!1;switch(!0){case/clear/.test(b):f="";break;case/help/.test(b):f="Available commands:<br />"+e.availableCommands;break;case/play\s+[a-z0-9]([a-z0-9]|\-)+/.test(b):var g=b.split("play ")[1].toLowerCase();c.playSong(g);break;case/project\s+[0-9]+/.test(b):var h=b;h="#"+b.replace(/\s/g,"-"),f=c.goTo(h,null);break;case/shutdown/.test(b):a("body").html("<h4 class='shutdown-title'>Goodbye.</h4><p class='shutdown-txt'>Click anywhere to go back.</p>"),a("html").addClass("black").css("cursor","pointer"),a("html").click(function(){window.location.reload()});break;default:d=!1}return d&&(e.currentLine=""),null!==f&&(e.aboveOutput=f,e.update()),d},playAudio:function(b){return 0===a(b).length?!1:(b.play(),!0)},registerEvents:function(){var b=[],c={};"desktop"==e.clientScreen&&(b=d.desktopClicks(),c=d.keyboardEvents()),"mobile"==e.clientScreen&&(b=d.mobileClicks()),b.length>0&&a(e.image).bind("click",b[0]),a(e.terminal).bind("contentchanged",function(){for(var b in c)a(b).on("keydown",c[b])})},update:function(b,c){b=void 0===b||null===b?e.aboveOutput:b,c=void 0===c||null===c?e.currentLine:c;var d=e.beginCommandStr+" <p class='input' contenteditable='true'>"+c+"</p>";e.initalized||(d="<p class='input' onfocus='this.value = this.value;' contenteditable='true'>"+c+"</p>"),d="<p class='above-output'>"+b+"</p>"+d,a(e.terminal).html(d),a(e.terminal).trigger("contentchanged")}};a(document).ready(function(){e.init()}),a.fn.terminal=function(){if(!this.length)return console.log("js-terminal could not be initalized. Call .terminal() on a valid jQuery object."),!1;var b=this,c={input:".terminal .input",display:".terminal .display",audio:".terminal #audio"},d=!1;a:{for(var e in c)if(!a(c[e],b).length)break a;d=!0}return!0}}(jQuery);