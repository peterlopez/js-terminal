/*! js-terminal 2015-08-30 */
!function(a){var b={goTo:function(b,c){return null!==c&&""!==c&&void 0!==c&&(window.location=c),a(name).length>0?(setTimeout(function(){a("html, body").animate({scrollTop:a(elID).offset().top-100},1e3)},500),"Taking you to <span class='highlight'>"+b+"</span>.."):"Cannot find <span class='highlight'>"+b+"</span>.."},playSong:function(b){var c="http://phpete.me/sites/default/files/"+b+".mp3";return d.audioLoaded?(d.playAudio(d.audioEl()),!0):void a(d.audioEl(c)).load(c,function(a,c,e){"error"==c?(d.update("Cannot find song '"+b+"'",null),d.audioLoaded=!1):(d.update("Playing "+b+"..",null),d.playAudio(d.audioEl()),d.audioLoaded=!0)})}},c={clicks:[],desktopClicks:function(){return c.clicks[0]=function(){a(d.image).unbind("click"),d.currentClick+=1,d.currentClick<c.clicks.length&&a(d.image).bind("click",c.clicks[d.currentClick]),d.aboveOutput="[login]<br />type <i>help</i> for instructions<br />",d.update(),d.focusCursor()},c.clicks[1]=function(b){return a(b.target).hasClass("input")?!1:void d.focusCursor()},c.clicks},keyboardEvents:function(){var b={};return b[d.input]=function(b){switch("play"===a(d.input).text()&&a(d.input).tooltip({items:"p",position:{my:"center top+3",at:"center center"},content:"Type 'song' or the name of a song like:<br>'play song' or 'play happy-birthday'"}),b.keyCode){case 13:d.currentLine=a(d.input).text().trim();var c=d.currentLine,e=d.processCommand(c);return e?d.commandsList.push(c):(d.aboveOutput="Unrecognized command, try again or<br />type <span class='highlight'>help</span> for options<br />",d.update()),d.focusCursor(),!1;case 38:var f=d.commandsList[d.commandsList.length-1];if(void 0===f)return!1;d.aboveOutput=d.beginCommandStr+f,d.currentLine=f,d.update()}},b},mobileClicks:function(){var a=[];return a}},d={commandsList:[],clientScreen:"",currentClick:0,deviceDependentText:"",initalized:!1,audioLoaded:!1,image:".iMac-img, #iMac .terminal",input:"#iMac .terminal .input",terminal:"#iMac .terminal",audioElement:"#audio",aboveOutput:"",currentLine:"",availableCommands:"<span class='highlight'>clear</span> - Clear output<br /><span class='highlight'>help</span> - Display all available commands<br /><span class='highlight'>play song</span> - I'll play a song on the piano<br /><span class='highlight'>project [#]</span> - Go to a project where [#] is the project ID<br /><span class='highlight'>shutdown</span> - sign off this site<br />",beginCommandStr:"<span class='begin-command'>>_ </span>",greeting:this.beginCommandStr+"print greeting();<br />Hello world!<br />My name is <span class='highlight'>Peter Lopez</span><br /><br />I'm a programmer and web<br />developer<br /><br />"+this.deviceDependentText,audioEl:function(b){b=void 0===b||null===b?"":b;var c=null,e=d.audioElement;return 0===a(e).length?(c=document.createElement("audio"),c.setAttribute("src",b),c.setAttribute("autoplay","autoplay")):c=a(e).get(0),c},init:function(){d.initDeviceSpecificSettings(),d.registerEvents(),d.aboveOutput=d.beginCommandStr+"print greeting();<br />Hello world!<br />My name is <span class='highlight'>Peter Lopez</span><br /><br />I'm a programmer and web<br />developer<br /><br />"+d.deviceDependentText,d.update(),d.initalized=!0},initDeviceSpecificSettings:function(){Mobile.isMobile()||(d.clientScreen="desktop",a(d.terminal).css("cursor","pointer"),d.deviceDependentText="This is my iMac, you can<br />interact with it by clicking on it")},focusCursor:function(){var b,c,e=a(d.input)[0];b=document.createRange(),b.selectNodeContents(e),b.collapse(!1),c=window.getSelection(),c.removeAllRanges(),c.addRange(b),e.focus()},processCommand:function(c){var e=!0,f=null;if(c=c.trim(),""===c)return!1;switch(!0){case/clear/.test(c):f="";break;case/help/.test(c):f="Available commands:<br />"+d.availableCommands;break;case/play\s+[a-z0-9]([a-z0-9]|\-)+/.test(c):var g=c.split("play ")[1].toLowerCase();b.playSong(g);break;case/project\s+[0-9]+/.test(c):var h=c;h="#"+c.replace(/\s/g,"-"),f=b.goTo(h,null);break;case/shutdown/.test(c):a("body").html("<h4 class='shutdown-title'>Goodbye.</h4><p class='shutdown-txt'>Click anywhere to go back.</p>"),a("html").addClass("black").css("cursor","pointer"),a("html").click(function(){window.location.reload()});break;default:e=!1}return e&&(d.currentLine=""),null!==f&&(d.aboveOutput=f,d.update()),e},playAudio:function(b){return 0===a(b).length?!1:(b.play(),!0)},registerEvents:function(){var b=[],e={};"desktop"==d.clientScreen&&(b=c.desktopClicks(),e=c.keyboardEvents()),"mobile"==d.clientScreen&&(b=c.mobileClicks()),b.length>0&&a(d.image).bind("click",b[0]),a(d.terminal).bind("contentchanged",function(){for(var b in e)a(b).on("keydown",e[b])})},update:function(b,c){b=void 0===b||null===b?d.aboveOutput:b,c=void 0===c||null===c?d.currentLine:c;var e=d.beginCommandStr+" <p class='input' contenteditable='true'>"+c+"</p>";d.initalized||(e="<p class='input' onfocus='this.value = this.value;' contenteditable='true'>"+c+"</p>"),e="<p class='above-output'>"+b+"</p>"+e,a(d.terminal).html(e),a(d.terminal).trigger("contentchanged")}};a(document).ready(function(){d.init()})}(jQuery);